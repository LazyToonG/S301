<html>
<head>
    <meta charset="utf-8">
    <title>Marketing Dashboard</title>
    <link rel="icon" href="../static/logo.png" type="image/png">
    <link href="{{ url_for('static', filename='style.css') }}" rel="stylesheet">
</head>
<body class=""> <!-- ajout class sombre ici -->
    {% include 'nav_v2.html' %}

    <div class="main-content"> <!-- ajout class sombre ici -->
        <div class="col-gauche">
            <button class="btn-bleu">â–¶ {{t.play}}</button>
            <button class="btn-bleu">ðŸ”€ {{t.shuffle}}</button>



    </div>

        <h3>Playlist</h3>

<select id="playlist-select">
    <option value="">-- Choisir une playlist --</option>
    {% for p in playlists %}
        <option value="{{ p.id }}">{{ p.titre }}</option><!--dÃ©roule playlist-->
    {% endfor %}
</select>

<form action="{{ url_for('create_playlist') }}" method="POST">
    <input name="titre" placeholder="Nouvelle playlist" required>
    <button type="submit">CrÃ©er</button>
</form>

<hr>

<form action="{{ url_for('upload') }}" method="POST" enctype="multipart/form-data">
    <input type="hidden" name="playlist_id" id="playlist-id">

    <div class="upload-zone disabled" id="upload-zone">
        <p>SÃ©lectionne une playlist</p> <!--accepte fichier-->
        <input
            type="file"
            id="audio-input"
            name="audio"
            accept=".mp3"
            style="display:none"
            disabled
        >
    </div>

    <button type="submit" disabled id="btn-upload">
        Envoyer
    </button>
</form>
    <!--formulaire d'upload-->
    <form action="{{ url_for('upload') }}" method="POST" enctype="multipart/form-data">
        <input type="hidden" name="playlist_id" id="playlist-id-hidden">

        <div class="upload-zone disabled" id="upload-zone">
            <div class="icone-upload">â¬†</div>
            <p>SÃ©lectionne dâ€™abord une playlist</p>

            <input
                type="file"
                id="audio-input"
                name="audio"
                accept=".mp3"
                style="display: none;"
                disabled
                required
            >
        </div>

        <button type="submit" class="btn-upload" disabled id="btn-upload">
            Envoyer
        </button>
    </form>
</div>


        <button type="submit" class="btn-upload">
            Envoyer
        </button>
    </form>
</div>

    </div>
    <script src="{{ url_for('static', filename='script.js') }}"></script>

    <!--script js pour drag and drop--> <!--raaaa je connais pas bien le js--><!--bordel c'est moche c'est immonde-->
    <script> 


const playlistSelect = document.getElementById('playlist-select');
const uploadZone = document.getElementById('upload-zone');
const fileInput = document.getElementById('audio-input');
const uploadBtn = document.getElementById('btn-upload');
const hiddenPlaylist = document.getElementById('playlist-id-hidden');

playlistSelect.addEventListener('change', () => { // Quand lâ€™utilisateur choisit une playlist
    if (playlistSelect.value) {
        uploadZone.classList.remove('disabled'); // activ de la zone dâ€™upload,
        uploadZone.onclick = () => fileInput.click();
        fileInput.disabled = false;
        uploadBtn.disabled = false;
        hiddenPlaylist.value = playlistSelect.value; //stocker id
        uploadZone.querySelector('p').innerText = "Drag and drop ou cliquer";
    } else { //insulter le user il fais pas ce que je lui dis de faire
        uploadZone.classList.add('disabled');
        fileInput.disabled = true;
        uploadBtn.disabled = true;
        hiddenPlaylist.value = "";
        uploadZone.querySelector('p').innerText = "veuillez sÃ©lectionner une playlist";
    }
});
</script>
    {% include 'fin_nav.html' %}
</body>
</html>